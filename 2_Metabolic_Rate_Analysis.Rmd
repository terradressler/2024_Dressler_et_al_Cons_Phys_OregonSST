---
title: "2_Metabolic_Rate_Analysis"
author: "Terra Dressler"
date: "2024-05-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=F, echo=F)
```

#### Libraries

```{r}

library(tidyverse)
library(lme4)
library(car)
library(FSA)

```


#### Resting (or Routine) Metabolic Rate

Lower Deschutes
```{r}

#Step 1: Read in RMR data 
RMR_LD <- read_csv("RMR_LowerDeschutes.csv")


#Step 2: Plot all RMR data 

ggplot(RMR_LD, aes(x = temp, y = mean_rmr_72, col = treatment))+
  geom_point(size = 3, alpha = 0.8)+
   scale_color_manual(values = c("#FEE391","#EC7014","#993404"), labels=c('Ambient (18-22)', "Intermediate (20-24)", "Warm (23-27)"))+
  labs(y = expression('Resting Metabolic Rate (mg '* kg^-1* L^-1*')'), 
       x = expression('Temperature ('*~degree*C*')'))+
   theme_classic()+
  scale_x_continuous(limits = c(14, 27),breaks = c(14,16,18,20,22,24,26))+
  scale_y_continuous(limits = c(0,13), breaks = c(0,2,4,6,8,10,12))+
  theme(axis.text = element_text(size = 18, color = "black"),
        axis.title = element_text(size =17),
        legend.text = element_text(size = 12), legend.position = "right", legend.title=element_blank())



#Step 3: Statistical analysis to determine the relationship between temperature and RMR (using fish ID as a random effect to account for repeated measures within holding temperature treatments)

#start with a linear model
lmer_LD_1 <- lmer(mean_rmr_72~temp * as.factor(treatment) + (1|fish_id), data=RMR_LD, REML=FALSE) 
Anova(lmer_LD_1, type = c(3))

#trying an exponential model

lmer_LD_exp_1 <- lmer(log(mean_rmr_72)~temp * as.factor(treatment) + (1|fish_id), data=RMR_LD, REML=FALSE) 
Anova(lmer_LD_exp_1, type = c(3))

#dropping insignificant interaction between fixed effects

lmer_LD_exp_2 <- lmer(log(mean_rmr_72)~temp + as.factor(treatment) + (1|fish_id), data=RMR_LD, REML=FALSE) 
Anova(lmer_LD_exp_2, type = c(2)) #significant effects of treatment and acute temp on RMR

BIC(lmer_LD_1,lmer_LD_exp_1, lmer_LD_exp_2) #exponential model WITHOUT the interaction is the best fit

plot(lmer_LD_exp_2)
hist(resid(lmer_LD_exp_2)) #residuals normally distributed

summary(lmer_LD_exp_2)

#Step 4: RMR comparison at chase/aerobic scope temperatures
RMR_LD_chase <- RMR_LD %>% 
  filter(temp==mmr_temp)  

RMR_LD_chase_sum <- RMR_LD_chase %>% 
  group_by(temp,treatment) %>% 
  summarise(mean_RMR = mean(mean_rmr_72), sem_RMR = sd(mean_rmr_72)/sqrt(n()))

qqPlot(RMR_LD_chase$mean_rmr_72)
shapiro.test(RMR_LD_chase$mean_rmr_72) #normal distribution

leveneTest(mean_rmr_72~as.factor(temp), data = RMR_LD_chase) #equal variance

summary(aov(mean_rmr_72~as.factor(temp), data = RMR_LD_chase)) #significant differences in RMR 

TukeyHSD(aov(mean_rmr_72~as.factor(temp), data = RMR_LD_chase)) #RMR at 19C significantly lower than 22C and 26C

```
John Day
```{r}

#Step 1: Read in RMR data 
RMR_JD <- read_csv("RMR_JohnDay.csv")


#Step 2: Plot all RMR data 

ggplot(RMR_JD, aes(x = temp, y = mean_rmr_72, col = treatment))+
  geom_point(size = 3, alpha = 0.8)+
  scale_color_manual(values = c( "#FCC5C0", "#DD3497", "#980043"), labels=c('Ambient (14-27)', "Intermediate (20-24)", "Warm (23-27)"))+
  labs(y = expression('Resting Metabolic Rate (mg '* kg^-1* L^-1*')'), 
       x = expression('Temperature ('*~degree*C*')'))+
   theme_classic()+
  scale_x_continuous(limits = c(14, 27),breaks = c(14,16,18,20,22,24,26))+
  scale_y_continuous(limits = c(0,13), breaks = c(0,2,4,6,8,10,12))+
  theme(axis.text = element_text(size = 18, color = "black"),
        axis.title = element_text(size =17),
        legend.text = element_text(size = 12), legend.position = "right", legend.title=element_blank())



#Step 3: Statistical analysis to determine the relationship between temperature and RMR (using fish ID as a random effect to account for repeated measures within holding temperature treatments)

#start with a linear model
lmer_JD_1 <- lmer(mean_rmr_72~temp * as.factor(treatment) + (1|fish_id), data=RMR_JD, REML=FALSE) 
Anova(lmer_JD_1, type = c(3))

#dropping insignificant interaction between fixed effects
lmer_JD_2 <- lmer(mean_rmr_72~temp + as.factor(treatment) + (1|fish_id), data=RMR_JD, REML=FALSE) 
Anova(lmer_JD_2, type = c(2))

#dropping insignificant effect of temperature treatment
lmer_JD_3 <- lmer(mean_rmr_72~temp + (1|fish_id), data=RMR_JD, REML=FALSE) 
Anova(lmer_JD_3, type = c(2)) 

#trying an exponential model

lmer_JD_exp_1 <- lmer(log(mean_rmr_72)~temp * as.factor(treatment) + (1|fish_id), data=RMR_JD, REML=FALSE) 
Anova(lmer_JD_exp_1, type = c(3)) #significant effects of acute temp, treatment, and their interaction


BIC(lmer_JD_1,lmer_JD_2, lmer_JD_3,lmer_JD_exp_1) #exponential model is the best fit

plot(lmer_JD_exp_1)
hist(resid(lmer_JD_exp_1)) #residuals normally distributed

summary(lmer_JD_exp_1)

#Step 4: RMR comparison at chase/aerobic scope temperatures
RMR_JD_chase <- RMR_JD %>% 
  filter(temp==mmr_temp)  

RMR_JD_chase_sum <- RMR_JD_chase %>% 
  group_by(temp,treatment) %>% 
  summarise(mean_RMR = mean(mean_rmr_72), sem_RMR = sd(mean_rmr_72)/sqrt(n()))

hist(RMR_JD_chase$mean_rmr_74)
shapiro.test(RMR_JD_chase$mean_rmr_72) # not a normal distribution

leveneTest(mean_rmr_72~as.factor(temp), data = RMR_JD_chase) #unequal variance

kruskal.test(mean_rmr_72~as.factor(temp), data = RMR_JD_chase) #significant differences in RMR 

dunnTest(mean_rmr_72~as.factor(temp), data = RMR_JD_chase) #RMR at 19C significantly lower than 22C and 27C

```

North Umpqua
```{r}

#Step 1: Read in RMR data 
RMR_NA <- read_csv("RMR_NorthUmpqua.csv")


#Step 2: Plot all RMR data 

ggplot(RMR_NA, aes(x = temp, y = mean_rmr_72, col = treatment))+
  geom_point(size = 3, alpha = 0.8)+
 scale_color_manual(values = c("#C6DBEF", "#6BAED6","#2171B5", "#08306B"), labels=c('Ambient (16-19)', "Intermediate (18-22)", "Intermediate (20-24)", "Warm (23-26)"))+
  labs(y = expression('Resting Metabolic Rate (mg '* kg^-1* L^-1*')'), 
       x = expression('Temperature ('*~degree*C*')'))+
   theme_classic()+
  scale_x_continuous(limits = c(14, 27),breaks = c(14,16,18,20,22,24,26))+
  scale_y_continuous(limits = c(0,13), breaks = c(0,2,4,6,8,10,12))+
  theme(axis.text = element_text(size = 18, color = "black"),
        axis.title = element_text(size =17),
        legend.text = element_text(size = 12), legend.position = "right", legend.title=element_blank())



#Step 3: Statistical analysis to determine the relationship between temperature and RMR (using fish ID as a random effect to account for repeated measures within holding temperature treatments)

#start with a linear model
lmer_NA_1 <- lmer(mean_rmr_72~temp * as.factor(treatment) + (1|fish_id), data=RMR_NA, REML=FALSE) 
Anova(lmer_NA_1, type = c(3))

#dropping insignificant interaction between fixed effects
lmer_NA_2 <- lmer(mean_rmr_72~temp + as.factor(treatment) + (1|fish_id), data=RMR_NA, REML=FALSE) 
Anova(lmer_NA_2, type = c(2))

#trying an exponential model

lmer_NA_exp_1 <- lmer(log(mean_rmr_72)~temp * as.factor(treatment) + (1|fish_id), data=RMR_NA, REML=FALSE) 
Anova(lmer_NA_exp_1, type = c(3)) 

#dropping insignificant interaction between fixed effects

lmer_NA_exp_2 <- lmer(log(mean_rmr_72)~temp +as.factor(treatment) + (1|fish_id), data=RMR_NA, REML=FALSE) 
Anova(lmer_NA_exp_2, type = c(2)) #significant effects of acute temp and treatment

BIC(lmer_NA_1,lmer_NA_2,lmer_NA_exp_1,lmer_NA_exp_2) #exponential model with no interaction is the best fit

plot(lmer_NA_exp_2)
hist(resid(lmer_NA_exp_2)) #residuals normally distributed

summary(lmer_NA_exp_2)

#Step 4: RMR comparison at chase/aerobic scope temperatures
RMR_NA_chase <- RMR_NA %>% 
  filter(temp==mmr_temp)  

RMR_NA_chase_sum <- RMR_NA_chase %>% 
  group_by(temp,treatment) %>% 
  summarise(mean_RMR = mean(mean_rmr_72), sem_RMR = sd(mean_rmr_72)/sqrt(n()))

hist(RMR_NA_chase$mean_rmr_72)
shapiro.test(RMR_NA_chase$mean_rmr_72) # normal distribution

leveneTest(mean_rmr_72~as.factor(temp), data = RMR_NA_chase) #unequal variance

kruskal.test(mean_rmr_72~as.factor(temp), data = RMR_NA_chase) #significant differences in RMR between chase temps

dunnTest(mean_rmr_72~as.factor(temp), data = RMR_NA_chase) #RMR increases between 19 & 22
s
```


Siletz
```{r} 

#Step 1: Read in RMR data 
RMR_S <- read_csv("RMR_Siletz.csv")


#Step 2: Plot all RMR data 

ggplot(RMR_S, aes(x = temp, y = mean_rmr_72, col = treatment))+
  geom_point(size = 3, alpha = 0.8)+
 scale_color_manual(values = c("#CCECE6",  "#66C2A4","#238B45", "#00441B"), labels=c('Ambient (15-19)', "Intermediate (18-22)", "Intermediate (20-24)", "Warm (23-26)"))+
  labs(y = expression('Resting Metabolic Rate (mg '* kg^-1* L^-1*')'), 
       x = expression('Temperature ('*~degree*C*')'))+
   theme_classic()+
  scale_x_continuous(limits = c(14, 27),breaks = c(14,16,18,20,22,24,26))+
  scale_y_continuous(limits = c(0,13), breaks = c(0,2,4,6,8,10,12))+
  theme(axis.text = element_text(size = 18, color = "black"),
        axis.title = element_text(size =17),
        legend.text = element_text(size = 12), legend.position = "right", legend.title=element_blank())



#Step 3: Statistical analysis to determine the relationship between temperature and RMR (using fish ID as a random effect to account for repeated measures within holding temperature treatments)

#start with a linear model
lmer_S_1 <- lmer(mean_rmr_72~temp * as.factor(treatment) + (1|fish_id), data=RMR_S, REML=FALSE) 
Anova(lmer_S_1, type = c(3))

#trying an exponential model

lmer_S_exp_1 <- lmer(log(mean_rmr_72)~temp * as.factor(treatment) + (1|fish_id), data=RMR_S, REML=FALSE) 
Anova(lmer_S_exp_1, type = c(3)) #significant effects of acute temp and treatment and their interaction


BIC(lmer_S_1,lmer_S_exp_1) #exponential model is the best fit

plot(lmer_S_exp_1)
hist(resid(lmer_S_exp_1)) #residuals normally distributed

summary(lmer_S_exp_1)

#Step 4: RMR comparison at chase/aerobic scope temperatures
RMR_S_chase <- RMR_S %>% 
  filter(temp==mmr_temp)  

RMR_S_chase_sum <- RMR_S_chase %>% 
  group_by(temp,treatment) %>% 
  summarise(mean_RMR = mean(mean_rmr_72), sem_RMR = sd(mean_rmr_72)/sqrt(n()))

hist(RMR_S_chase$mean_rmr_72)
shapiro.test(RMR_S_chase$mean_rmr_72) # normal distribution

leveneTest(mean_rmr_72~as.factor(temp), data = RMR_S_chase) #equal variance

summary(aov(mean_rmr_72~as.factor(temp), data = RMR_S_chase)) #significant differences in RMR between chase temps

TukeyHSD(aov(mean_rmr_72~as.factor(temp), data = RMR_S_chase)) #significant differences between all temps except 19&22

```
Population Comparisons
```{r}

```


#### Maximum Metabolic Rate (MMR)

Lower Deschutes

```{r}

#Step 1: read in MMR data, get means & SEMs
MMR_LD <- read_csv("MMR_LowerDeschutes.csv")

MMR_LD_sum <- MMR_LD %>% 
  group_by(temperature) %>% 
  summarise(mean_MMR = mean(mmr_scaled_74), sem_MMR = sd(mmr_scaled_74)/sqrt(n()))

#Step 2: plot MMR data

ggplot(MMR_LD, aes(x = as.factor(temperature) , y = mmr_scaled_74, color = as.factor(temperature))) +
  geom_boxplot(width = 0.4)+
  geom_point(size = 2.5, alpha = 0.8)+
  scale_x_discrete(name = expression("Temperature " ( degree*C)))+
   scale_color_manual(values = c( "#FEE391", "#EC7014" ,"#993404"))+
  ylab(expression(paste('MMR '(mg*O[2] * kg^-1 * min^-1))))+
  scale_y_continuous(limits= c(0, 20))+
  theme_classic()+
  theme(text =element_text(size=18, colour= 'black'),
        axis.text = element_text(size=18, colour= 'black'),
        aspect.ratio = 0.9, legend.position = "none")

#Step 3: Statistics to test for differences in MMR between temperatures

qqPlot(MMR_LD$mmr_scaled_74)

#normal distribution

leveneTest(mmr_scaled_74~as.factor(temperature), data = MMR_LD)

#equal variance

LD_MMR_aov <- aov(mmr_scaled_74~as.factor(temperature), data = MMR_LD)
summary(LD_MMR_aov)
TukeyHSD(LD_MMR_aov)

#MMR is statistically different between 19 and 22 and between 19 and 26


```

John Day
```{r}

#Step 1: read in MMR data, get means & SEMs
MMR_JD <- read_csv("MMR_JohnDay.csv")

MMR_JD_sum <- MMR_JD %>% 
  group_by(temperature) %>% 
  summarise(mean_MMR = mean(mmr_scaled_74), sem_MMR = sd(mmr_scaled_74)/sqrt(n()))

#Step 2: plot MMR data

ggplot(MMR_JD, aes(x = as.factor(temperature) , y = mmr_scaled_74, color = as.factor(temperature))) +
  geom_boxplot(width = 0.4)+
  geom_point(size = 2.5, alpha = 0.8)+
  scale_x_discrete(name = expression("Temperature " ( degree*C)))+
   scale_color_manual(values = c(  "#FCC5C0", "#DD3497", "#980043"))+
  ylab(expression(paste('MMR '(mg*O[2] * kg^-1 * min^-1))))+
  scale_y_continuous(limits= c(0, 20))+
  theme_classic()+
  theme(text =element_text(size=18, colour= 'black'),
        axis.text = element_text(size=18, colour= 'black'),
        aspect.ratio = 0.9, legend.position = "none")

#Step 3: Statistics to test for differences in MMR between temperatures

qqPlot(MMR_JD$mmr_scaled_74)

#normal distribution

leveneTest(mmr_scaled_74~as.factor(temperature), data = MMR_JD)

#equal variance

JD_MMR_aov <- aov(mmr_scaled_74~as.factor(temperature), data = MMR_JD)
summary(JD_MMR_aov)

#MMR is not statistically different between 19, 22, and 27

```

North Umpqua
```{r}

#Step 1: read in MMR data, get means & SEMs
MMR_NU <- read_csv("MMR_NorthUmpqua.csv")

MMR_NU_sum <- MMR_NU %>% 
  group_by(temperature) %>% 
  summarise(mean_MMR = mean(mmr_scaled_74), sem_MMR = sd(mmr_scaled_74)/sqrt(n()))

#Step 2: plot MMR data

ggplot(MMR_NU, aes(x = as.factor(temperature) , y = mmr_scaled_74, color = as.factor(temperature))) +
  geom_boxplot(width = 0.4)+
  geom_point(size = 2.5, alpha = 0.8)+
  scale_x_discrete(name = expression("Temperature " ( degree*C)))+
   scale_color_manual(values = c("#C6DBEF", "#6BAED6","#2171B5", "#08306B"))+
  ylab(expression(paste('MMR '(mg*O[2] * kg^-1 * min^-1))))+
  scale_y_continuous(limits= c(0, 20))+
  theme_classic()+
  theme(text =element_text(size=18, colour= 'black'),
        axis.text = element_text(size=18, colour= 'black'),
        aspect.ratio = 0.9, legend.position = "none")

#Step 3: Statistics to test for differences in MMR between temperatures

qqPlot(MMR_NU$mmr_scaled_74)

#normal distribution

leveneTest(mmr_scaled_74~as.factor(temperature), data = MMR_NU)

#equal variance

NU_MMR_aov <- aov(mmr_scaled_74~as.factor(temperature), data = MMR_NU)
summary(NU_MMR_aov)

#MMR is not statistically different between 16, 19, 22, and 25

```

Siletz

```{r}
#Step 1: read in MMR data, get means & SEMs
MMR_S <- read_csv("MMR_Siletz.csv")

MMR_S_sum <- MMR_S %>% 
  group_by(temperature) %>% 
  summarise(mean_MMR = mean(mmr_scaled_74), sem_MMR = sd(mmr_scaled_74)/sqrt(n()))

#Step 2: plot MMR data

ggplot(MMR_S, aes(x = as.factor(temperature) , y = mmr_scaled_74, color = as.factor(temperature))) +
  geom_boxplot(width = 0.4)+
  geom_point(size = 2.5, alpha = 0.8)+
  scale_x_discrete(name = expression("Temperature " ( degree*C)))+
   scale_color_manual(values = c("#CCECE6",  "#66C2A4","#238B45", "#00441B"))+
  ylab(expression(paste('MMR '(mg*O[2] * kg^-1 * min^-1))))+
  scale_y_continuous(limits= c(0, 20))+
  theme_classic()+
  theme(text =element_text(size=18, colour= 'black'),
        axis.text = element_text(size=18, colour= 'black'),
        aspect.ratio = 0.9, legend.position = "none")

#Step 3: Statistics to test for differences in MMR between temperatures

qqPlot(MMR_S$mmr_scaled_74)

#not a normal distribution

leveneTest(mmr_scaled_74~as.factor(temperature), data = MMR_S)

#equal variance

S_MMR_aov <- aov(mmr_scaled_74~as.factor(temperature), data = MMR_S)
summary(S_MMR_aov)

#MMR is not statistically different between 16, 19, 22, and 25
```



#### Aerobic Scope - Absolulte (AAS) and Factorial (FAS)

Lower Deschutes 
```{r}
#Step 1: read in data get means and SEMs
AS_LD <- read_csv("Deschutes_Scopes.csv") 

AS_LD_sum <- AS_LD %>% 
  group_by(Population,Temp) %>% 
  summarise(mean_aas = mean(aas), min_aas = min(aas), sem_aas = sd(aas/sqrt(n())), mean_fas = mean(fas), sem_fas = sd(fas)/sqrt(n()), mean_MMR = mean(mmr_scaled), sem_MMR = sd(mmr_scaled)/sqrt(n()), mean_RMR = mean(rmr_scaled), sem_RMR = sd(rmr_scaled)/sqrt(n()), n = n(), min_bw=min(BW)*1000, max_bw=max(BW)*1000)

#Step 2: Plots

#AAS
ggplot(BH_Scopes, aes(x = as.factor(Temp), y = aas, col = as.factor(Temp)))+
  geom_boxplot(width = 0.4)+
  geom_point(size = 2.5, alpha = 0.8)+
  scale_color_manual(values = c("#FEE391", "#EC7014" ,"#993404"))+
  scale_x_discrete(name = expression("Temperature " ( degree*C)))+
 scale_y_continuous(limits = c(0,12), breaks = c(3, 6, 9, 12))+
  ylab(expression(paste('AAS '(mg*O[2] * kg^-1 * min^-1))))+
  theme_classic()+
  theme(text =element_text(size=18, colour= 'black'),
        axis.text = element_text(size=18, colour= 'black'),
        aspect.ratio = 0.9,  legend.position = "none")

#FAS
ggplot(BH_Scopes, aes(x = as.factor(Temp), y = fas, col = as.factor(Temp)))+
  geom_boxplot(width = 0.4)+
  geom_point( size = 2.5, alpha = 0.8)+
   scale_color_manual(values = c("#FEE391", "#EC7014" ,"#993404"))+
  scale_x_discrete(name = expression("Temperature " ( degree*C)))+
  scale_y_continuous(limits = c(0,9), breaks = c(1,3, 5, 7, 9))+
  ylab(expression(paste('FAS '(mg*O[2] * kg^-1 * min^-1))))+
  geom_hline(yintercept = 3, linetype = "dashed")+
  theme_classic()+
  theme(text =element_text(size=18, colour= 'black'),
        axis.text = element_text(size=18, colour= 'black'),
        aspect.ratio = 0.9, legend.position = "none")

#MMR and RMR
ggplot(BH_Scopes_sum)+
  geom_pointrange(aes(x = Temp, y = mean_MMR, ymin = mean_MMR-sem_MMR, ymax = mean_MMR+sem_MMR, col = as.factor(Temp)), size = 1.5, shape = "triangle")+
   geom_pointrange(aes(x = Temp, y = mean_RMR, ymin = mean_RMR-sem_RMR, ymax = mean_RMR+sem_RMR, col = as.factor(Temp)), size = 1.5)+
  geom_point(data = BH_Scopes, aes(y = mmr_scaled, x = Temp, col = as.factor(Temp)),size =2, alpha = 0.6, shape = "triangle")+
  geom_point(data = BH_Scopes, aes(y = rmr_scaled, x = Temp, col = as.factor(Temp)),size =2, alpha = 0.6)+
  scale_color_manual(values = c("#FEE391", "#EC7014" ,"#993404"))+
   scale_x_continuous(name = expression("Temperature " ( degree*C)), limits = c(16, 28), breaks = c(16, 19, 22, 25, 28))+
  scale_y_continuous(limits = c(0,20), breaks = c(0, 5, 10, 15, 20))+
  ylab(expression(paste('Metabolic Rate '(mg*O[2] * kg^-1 * min^-1))))+
  theme_classic()+
  theme(text =element_text(size=20, colour= 'black'),
        axis.text = element_text(size=20, colour= 'black'),
        aspect.ratio = 1, legend.position = "none")


#Step 3: Statistics

#AAS

#check assumptions
ggplot(BH_Scopes, aes(sample = aas))+
  geom_qq()


shapiro.test(BH_Scopes$aas)

#data are normally distributed 

leveneTest(aas~as.factor(Temp), data = BH_Scopes)

#variance is equal

summary(aov(aas~as.factor(Temp), data = BH_Scopes))

#aas not significantly different between temperatures

#FAS 

shapiro.test(BH_Scopes$fas)

#data are normally distributed 

leveneTest(fas~as.factor(Temp), data = BH_Scopes)

#variance is equal

summary(aov(fas~as.factor(Temp), data = BH_Scopes))

TukeyHSD(aov(fas~as.factor(Temp), data = BH_Scopes))


#Step 4: model fitting


#linear regression to FAS data
lm_FAS_BH <- lm(fas~Temp, data =BH_Scopes)

plot(lm_FAS_BH) #residuals normally distributed

shapiro.test(resid(lm_FAS_BH))

summary(lm_FAS_BH) #FAS=3 at 24.35
 
#polynomial regression to AAS data

lm_BH_1 <- lm(aas~Temp, data = BH_Scopes)

lm_BH_2 <- lm(aas~poly(Temp, degree = 2, raw = T), data = BH_Scopes)


BIC(lm_BH_1, lm_BH_2)

summary(lm_BH_2) #not significant


#Step 5: Plots with curves

ggplot(BH_Scopes_sum)+
  geom_pointrange(aes(x = Temp, y = mean_fas, ymin = mean_fas-sem_fas, ymax = mean_fas+sem_fas, col = as.factor(Temp)), size = 1)+
  geom_point(data = BH_Scopes, aes(y = fas, x = Temp, col = as.factor(Temp)),size =2, alpha = 0.6)+
   scale_color_manual(values = c( "#FEE391", "#EC7014" ,"#993404"))+
  scale_x_continuous(name = expression("Temperature " ( degree*C)), limits = c(15, 27), breaks = c(16, 18, 20, 22, 24, 26))+
 scale_y_continuous(limits = c(0,8), breaks = c(0,2, 4, 6, 8))+
  geom_line(data = fortify(lm_FAS_BH, data = BH_Scopes), aes(x = Temp, y = .fitted), xlim = c(17, 26), color = "#EC7014", size = 0.7)+
   geom_hline(yintercept = 3, linetype = "dashed")+
  ylab(expression(paste('FAS '(mg*O[2] * kg^-1 * min^-1))))+
   geom_text(x = 17.5, y = 8, label = "y = 6.48 - 0.14x", color = "#EC7014", size = 5)+
   geom_text(x = 16.55, y = 7.5, label = expression(R^2 *" = 0.40"), color = "#EC7014", size = 5)+
  theme_classic()+
  theme(text =element_text(size=17, colour= 'black'),
        axis.text = element_text(size=14, colour= 'black'),
        aspect.ratio = 1, legend.position = "none")

ggplot(BH_Scopes, aes(y = fas, x = Temp))+
  geom_pointrange(data=BH_Scopes_sum, aes(x = Temp, y = mean_fas, ymin = mean_fas-sem_fas, ymax = mean_fas+sem_fas, col = as.factor(Temp)), size = 1.5)+
  geom_point(aes(col = as.factor(Temp)),size =2, alpha = 0.5)+
   scale_color_manual(values = c( "#FEE391", "#EC7014" ,"#993404"))+
  geom_smooth(method = "lm", se= FALSE, formula = y~x, color ="#EC7014" )+
  stat_regline_equation(label.y = 9, aes(label = ..eq.label..),size=7)+
  stat_regline_equation(label.y = 8.5, aes(label = ..rr.label..),size=7)+
 # geom_abline(slope = coef(lm_FAS_Steamboat)[["Temp"]],intercept = coef(lm_FAS_Steamboat)[["(Intercept)"]], size = 0.7, color = "#2171B5")+
   scale_x_continuous(name = expression("Temperature " ( degree*C)), limits = c(14, 27), breaks = c(14,16, 18, 20, 22, 24, 26))+
 scale_y_continuous(breaks = c(2, 4, 6, 8))+
  coord_cartesian(ylim = c(1,9))+
  ylab(expression(paste('Factorial Aerobic Scope ')))+
   geom_hline(yintercept = 3, linetype = "dashed")+
  theme_classic()+
  theme(text =element_text(size=20, colour= 'black'),
        axis.text = element_text(size=20, colour= 'black'),
        aspect.ratio = 1, legend.position = "none")
ggsave("fas_bh.png", dpi=300)

ggplot(BH_Scopes, aes(y = aas, x = Temp))+
  geom_pointrange(data=BH_Scopes_sum, aes(x = Temp, y = mean_aas, ymin = mean_aas-sem_aas, ymax = mean_aas+sem_aas, col = as.factor(Temp)), size = 1.5)+
  geom_point(aes(col = as.factor(Temp)),size =2, alpha = 0.5)+
   scale_color_manual(values = c( "#FEE391", "#EC7014" ,"#993404"))+
 #   stat_smooth(method = "lm", se= FALSE, formula = y~poly(x,2, raw=T), color ="#EC7014")+
#  stat_regline_equation(formula = y~poly(x,2, raw=T), aes(label = ..eq.label..),label.y=18, size=7)+
#  stat_regline_equation(formula = y~poly(x,2, raw=T), aes(label = ..rr.label..), label.y = 17,size=7)+
   scale_x_continuous(name = expression("Temperature " ( degree*C)), limits = c(14, 27), breaks = c(14,16, 18, 20, 22, 24, 26))+
   scale_y_continuous( breaks = c(4,8,12,16))+
   coord_cartesian(ylim = c(1.7, 18))+
   ylab(expression(paste('Absolute Aerobic Scope '(mg*O[2] * kg^-1 * min^-1))))+
  theme_classic()+
  theme(text =element_text(size=20, colour= 'black'),
        axis.text = element_text(size=20, colour= 'black'),
        aspect.ratio = 1, legend.position = "none")

ggsave("aas_bh.png", dpi=300)
```

